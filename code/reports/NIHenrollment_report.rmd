---
title: "NIH Enrollment Report"
author: "Dominick Lemas"
date: "10/04/2022"
output: html_document

---

```{r, include=FALSE}
##-------------- 
# **************************************************************************** #
# ***************                Project Overview              *************** #
# **************************************************************************** #

# Author:            Dominick J. Lemas
# Start Date:        10/04/2022 
# Date Modify:       
# Project:           The Breastfeeding and EArly Child Health
# IRB:               IRB201601034
#                   
#
# version: R version 4.0.2 (2020-06-22)
# version: Rstudio version Version 1.3.959 

# **************************************************************************** #
# ***************                Description                   *************** #
# **************************************************************************** #

# NOTE: This script consumes data that was generated by:
# ~/code/get_data/get_reportData_21221.Rmd
# ~/code/process_data/format_reportData_21221_NIHenrollment.Rmd

# PLAN: Complete NIH Enrollment Table.

project_name="The Breastfeeding and EArly Child Health Study"
irb_number="IRB201601034"
upstream_code="~/code/process_data/format_reportData_21221_NIHenrollment.Rmd"
report_id<-21221L
report_name= "BEACH Study Overview"
input_file="21221_NIHenrollment_clean.RData"

```


```{r, message=FALSE,include=FALSE}

# **************************************************************************** #
# ***************                Library                       *************** #
# **************************************************************************** #

library(codified)
library(tidyverse)

# https://cran.r-project.org/web/packages/codified/vignettes/nih-enrollment-html.html


```

```{r, message=FALSE,include=FALSE}

# **************************************************************************** #
# ***************              Load/Trim Data                  *************** #
# **************************************************************************** #

load("~/BEACH-reports/data/processed/21221_NIHenrollment_clean.RData")

ds=data %>%
  rename(gender=sex_nih,
         ethnicity=ethnicity_nih) %>%
  select(gender,ethnicity,race)
  
ds$gender=as.character(ds$gender)
ds$ethnicity=as.character(ds$ethnicity)
ds$race=as.character(ds$race)

# ds[ds$gender=="<NA>"]=NA

```

#### __Project Details__
Title: `r project_name`  
IRB Number: `r irb_number`  
Report Name (source-data): `r report_name`  
Report ID (source-data): `r report_id`  
Upstream Code: `r upstream_code`  
Input Data: `r input_file`

#### __Data Description__


```{r, message=FALSE,echo=FALSE}

# **************************************************************************** #
# ***************              Data Labels                     *************** #
# **************************************************************************** #

# gender

ds_lu_gender <- tibble::tribble(
  ~input,   ~displayed            ,
  "1"   ,  "Female"               ,
  "2"   ,  "Male"                 ,
  "<NA>"   ,  "Unknown/Not Reported"
)

# knitr::kable(ds_lu_gender, caption = "Gender Mapping")

# race

ds_lu_race <- tibble::tribble(
  ~input , ~displayed                                   ,
  "NativeAmerican"    , "American Indian/Alaska Native"              ,
  "Asian"             , "Asian",
  "PacificIsland"    , "Native Hawaiian or Other Pacific Islander"  ,
  "Black"    , "Black or African American"                  ,
  "White"    , "White"                                      ,
  "M"    , "More than One Race"                         ,
  "NA"    , "Unknown or Not Reported"
)

# knitr::kable(ds_lu_race, caption = "Race Mapping")

# ethnicity

ds_lu_ethnicity <- tibble::tribble(
  ~input,   ~displayed                      ,
  "2"   ,  "Not Hispanic or Latino"         ,
  "1"   ,  "Hispanic or Latino"             ,
  "0"   ,  "Unknown/Not Reported Ethnicity"
)
# knitr::kable(ds_lu_ethnicity, caption = "Ethnicity Mapping")

```


```{r, message=FALSE}

# **************************************************************************** #
# ***************         NIH enrollment table                 *************** #
# **************************************************************************** #

ds_summary_long <- codified::table_nih_enrollment(
  d              = ds,
  d_lu_gender    = ds_lu_gender,
  d_lu_race      = ds_lu_race,
  d_lu_ethnicity = ds_lu_ethnicity
)

knitr::kable(ds_summary_long, caption = "Counts of Each Subgroup")



codified::table_nih_enrollment_pretty(
  d              = ds,
  d_lu_gender    = ds_lu_gender,
  d_lu_race      = ds_lu_race,
  d_lu_ethnicity = ds_lu_ethnicity
)
```

